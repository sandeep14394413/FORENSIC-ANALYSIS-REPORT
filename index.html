<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Shield ‚Äî Universal AI Content Detector</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;900&family=Syne:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;background:#03020B;color:#E8EAF6;font-family:'Syne',sans-serif;overflow:hidden}
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-thumb{background:rgba(0,245,255,.3);border-radius:4px}
::-webkit-scrollbar-track{background:transparent}

/* Animations */
@keyframes rotCW   {to{transform:rotate(360deg)}}
@keyframes rotCCW  {to{transform:rotate(-360deg)}}
@keyframes pulse   {0%,100%{opacity:.4;transform:scale(1)}50%{opacity:1;transform:scale(1.07)}}
@keyframes blink   {0%,100%{opacity:1}50%{opacity:0}}
@keyframes scanX   {from{transform:translateX(-100vw)}to{transform:translateX(100vw)}}
@keyframes scanY   {from{transform:translateY(-100vh)}to{transform:translateY(100vh)}}
@keyframes fadeUp  {from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeIn  {from{opacity:0}to{opacity:1}}
@keyframes slideR  {from{opacity:0;transform:translateX(-16px)}to{opacity:1;transform:translateX(0)}}
@keyframes float   {0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
@keyframes glow    {0%,100%{text-shadow:0 0 10px currentColor}50%{text-shadow:0 0 28px currentColor,0 0 56px currentColor}}
@keyframes orbDrift{0%{transform:translate(0,0)}33%{transform:translate(60px,-40px)}66%{transform:translate(-40px,30px)}100%{transform:translate(0,0)}}
@keyframes waveBar {0%,100%{transform:scaleY(.12)}50%{transform:scaleY(1)}}
@keyframes ripple  {0%{transform:scale(0);opacity:.8}100%{transform:scale(3);opacity:0}}
@keyframes spin    {from{stroke-dashoffset:283}to{stroke-dashoffset:0}}
@keyframes countUp {from{opacity:0;transform:scale(.85)}to{opacity:1;transform:scale(1)}}

/* Vars */
:root{
  --bg:#03020B;--bg1:#07061A;--bg2:#0C0B22;
  --cyan:#00F5FF;--green:#39FF14;--red:#FF0055;--amber:#FFB700;--purple:#BF5FFF;
  --white:#E8EAF6;--dim:rgba(232,234,246,.55);--dimmer:rgba(232,234,246,.22);--dimmest:rgba(232,234,246,.10);
  --panel:rgba(255,255,255,.028);--border:rgba(0,245,255,.10);--borderB:rgba(0,245,255,.24);
}

/* Layout */
#app{display:flex;height:100vh;overflow:hidden;position:relative}
#bg-canvas{position:fixed;inset:0;pointer-events:none;z-index:0}
.hex-grid{position:fixed;inset:0;pointer-events:none;z-index:0;opacity:.05}
.scanline-h{position:fixed;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,rgba(0,245,255,.35),transparent);animation:scanX 7s linear infinite;z-index:1;pointer-events:none;top:0}
.scanline-v{position:fixed;top:0;bottom:0;width:2px;background:linear-gradient(180deg,transparent,rgba(0,245,255,.2),transparent);animation:scanY 9s linear infinite;z-index:1;pointer-events:none;left:0}
.orb{position:fixed;border-radius:50%;pointer-events:none;z-index:0}

/* Sidebar */
#sidebar{width:220px;flex-shrink:0;height:100%;background:rgba(7,6,26,.88);border-right:1px solid var(--border);backdrop-filter:blur(20px);display:flex;flex-direction:column;position:relative;z-index:10;transition:transform .3s}
.nav-logo{padding:22px 18px 18px;border-bottom:1px solid var(--border)}
.logo-title{font-family:'Orbitron',monospace;font-size:14px;font-weight:900;color:var(--cyan);letter-spacing:2px;text-shadow:0 0 20px rgba(0,245,255,.5)}
.logo-sub{font-size:9px;color:var(--dimmer);letter-spacing:2px;margin-top:2px}
.status-dot{width:7px;height:7px;border-radius:50%;background:var(--green);box-shadow:0 0 8px var(--green);animation:pulse 1.5s ease-in-out infinite;display:inline-block}
nav{padding:10px 0;flex:1}
.nav-item{display:flex;align-items:center;gap:12px;padding:11px 20px;font-size:11px;font-family:'Orbitron',monospace;letter-spacing:2px;color:var(--dimmer);border-left:2px solid transparent;cursor:pointer;transition:all .18s;user-select:none;margin:2px 0}
.nav-item:hover{color:var(--cyan);background:rgba(0,245,255,.06)}
.nav-item.active{color:var(--cyan);background:rgba(0,245,255,.12);border-left-color:var(--cyan)}
.nav-icon{font-size:15px}
.stats-section{padding:14px 16px;border-top:1px solid var(--border)}
.stat-row{display:flex;justify-content:space-between;align-items:center;padding:5px 0;border-bottom:1px solid var(--border)}
.stat-label{font-size:8px;color:var(--dimmer);font-family:'Orbitron',monospace;letter-spacing:1px}
.stat-val{font-family:'Orbitron',monospace;font-size:15px;font-weight:900}
.privacy-note{padding:12px 16px;background:rgba(57,255,20,.06);border-top:1px solid rgba(57,255,20,.15);font-size:9px;color:rgba(57,255,20,.8);line-height:1.6}

/* Main area */
#main{flex:1;display:flex;flex-direction:column;position:relative;z-index:2;overflow:hidden}
#topbar{height:52px;border-bottom:1px solid var(--border);background:rgba(7,6,26,.7);backdrop-filter:blur(20px);display:flex;align-items:center;justify-content:space-between;padding:0 24px;flex-shrink:0}
.topbar-dots{display:flex;gap:6px}
.topbar-dot{width:11px;height:11px;border-radius:50%;opacity:.7}
.topbar-title{font-family:'Orbitron',monospace;font-size:11px;color:var(--dimmer);letter-spacing:3px}
.topbar-right{display:flex;gap:10px;align-items:center}
#clock{font-size:10px;color:var(--dimmer);font-family:monospace}
#content{flex:1;overflow:hidden;position:relative}
.page{position:absolute;inset:0;overflow:auto;animation:fadeIn .3s ease}
.page.hidden{display:none}

/* Panel / Card */
.panel{border-radius:16px;background:var(--panel);border:1px solid var(--border);backdrop-filter:blur(14px);transition:border-color .2s,transform .2s;box-shadow:inset 0 1px 0 rgba(255,255,255,.03)}
.panel:hover{border-color:var(--borderB)}
.panel-glow-cyan{border-color:rgba(0,245,255,.28);box-shadow:0 0 28px rgba(0,245,255,.1),inset 0 1px 0 rgba(255,255,255,.04)}
.panel-glow-green{border-color:rgba(57,255,20,.28);box-shadow:0 0 28px rgba(57,255,20,.1)}
.panel-glow-red{border-color:rgba(255,0,85,.28);box-shadow:0 0 28px rgba(255,0,85,.1)}
.panel-glow-amber{border-color:rgba(255,183,0,.28);box-shadow:0 0 28px rgba(255,183,0,.1)}

/* Buttons */
.btn{font-family:'Orbitron',monospace;letter-spacing:2px;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:8px;transition:all .2s;border:none;font-weight:700;font-size:11px}
.btn-primary{padding:12px 28px;border-radius:12px;background:linear-gradient(135deg,var(--cyan),var(--green));color:#000;box-shadow:0 0 18px rgba(0,245,255,.3)}
.btn-primary:hover{box-shadow:0 0 40px rgba(0,245,255,.5),0 8px 30px rgba(0,0,0,.4);transform:translateY(-2px)}
.btn-primary.full{width:100%}
.btn-outline{padding:8px 18px;border-radius:10px;background:transparent;border:1px solid rgba(0,245,255,.3);color:var(--cyan);font-size:9px}
.btn-outline:hover{border-color:var(--cyan);background:rgba(0,245,255,.08)}
.btn-red-outline{padding:8px 18px;border-radius:10px;background:transparent;border:1px solid rgba(255,0,85,.3);color:var(--red);font-size:9px}
.btn-red-outline:hover{border-color:var(--red);background:rgba(255,0,85,.08)}

/* Badge */
.badge{display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:20px;font-size:9px;font-family:'Orbitron',monospace;font-weight:700;letter-spacing:1px}
.badge::before{content:'';width:5px;height:5px;border-radius:50%;background:currentColor;display:inline-block}

/* Section label */
.slabel{font-family:'Orbitron',monospace;font-size:9px;letter-spacing:3px;margin-bottom:12px;display:flex;align-items:center;gap:8px;color:var(--cyan)}
.slabel::before{content:'';width:3px;height:10px;background:currentColor;border-radius:2px}

/* Drop zone */
.drop-zone{border-radius:14px;border:1.5px dashed rgba(0,245,255,.28);min-height:160px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .3s;padding:20px;gap:10px;background:transparent}
.drop-zone:hover,.drop-zone.hovered{border-color:rgba(0,245,255,.6);background:rgba(0,245,255,.05)}
.drop-zone.drag-over{border-color:var(--green);background:rgba(57,255,20,.08);border-style:solid}

/* Progress bar */
.progress-bar{height:7px;background:rgba(255,255,255,.07);border-radius:4px;overflow:hidden}
.progress-fill{height:100%;border-radius:4px;background:linear-gradient(90deg,var(--cyan),var(--green));box-shadow:0 0 12px var(--cyan);transition:width .2s ease}

/* Waveform */
.waveform{display:flex;align-items:center;gap:2px}
.wave-bar{border-radius:2px;transform-origin:bottom;animation:waveBar .5s ease-in-out infinite alternate}

/* Frame grid */
.frame-grid{display:grid;grid-template-columns:repeat(10,1fr);gap:3px}
.frame-cell{aspect-ratio:1;border-radius:4px;cursor:default;border:1px solid transparent;transition:all .3s}

/* Heatmap bars */
.audio-seg{display:flex;align-items:center;gap:10px;margin-bottom:7px}
.audio-bar-bg{flex:1;height:5px;background:rgba(255,255,255,.06);border-radius:3px;overflow:hidden}
.audio-bar-fill{height:100%;border-radius:3px;transition:width 1s}

/* Step list */
.step-row{display:flex;gap:12px;align-items:flex-start;padding:10px 0;border-bottom:1px solid var(--border)}
.step-row:last-child{border-bottom:none}
.step-dot{width:28px;height:28px;border-radius:50%;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:12px;transition:all .3s}

/* History table */
.htable-head{display:grid;grid-template-columns:2fr 80px 130px 130px 1fr 50px;gap:10px;padding:12px 20px;border-bottom:1px solid var(--border);font-family:'Orbitron',monospace;font-size:9px;color:var(--dimmer);letter-spacing:2px}
.htable-row{display:grid;grid-template-columns:2fr 80px 130px 130px 1fr 50px;gap:10px;padding:13px 20px;border-bottom:1px solid var(--border);align-items:center;cursor:pointer;transition:background .18s}
.htable-row:hover{background:rgba(255,255,255,.03)}

/* Tooltip */
[data-tip]:hover::after{content:attr(data-tip);position:absolute;bottom:110%;left:50%;transform:translateX(-50%);background:#0C0B22;border:1px solid var(--border);border-radius:6px;padding:4px 8px;font-size:10px;white-space:nowrap;color:var(--dim);pointer-events:none;z-index:100}

/* Responsive hide sidebar on small screens */
@media(max-width:768px){
  #sidebar{position:fixed;left:0;top:0;bottom:0;transform:translateX(-100%);z-index:100}
  #sidebar.open{transform:translateX(0)}
  #menu-btn{display:flex!important}
}
</style>
</head>
<body>

<!-- Background layers -->
<canvas id="bg-canvas"></canvas>
<svg class="hex-grid" id="hex-svg"></svg>
<div class="scanline-h"></div>
<div class="scanline-v"></div>
<div class="orb" style="width:500px;height:500px;left:10%;top:15%;background:radial-gradient(circle,rgba(0,245,255,.06),transparent 70%);animation:orbDrift 14s ease-in-out infinite"></div>
<div class="orb" style="width:400px;height:400px;left:70%;top:60%;background:radial-gradient(circle,rgba(68,51,255,.07),transparent 70%);animation:orbDrift 18s ease-in-out infinite;animation-delay:-6s"></div>
<div class="orb" style="width:300px;height:300px;left:60%;top:5%;background:radial-gradient(circle,rgba(57,255,20,.05),transparent 70%);animation:orbDrift 12s ease-in-out infinite;animation-delay:-3s"></div>

<div id="app">

  <!-- SIDEBAR -->
  <aside id="sidebar">
    <div class="nav-logo">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px">
        <svg width="44" height="44" id="logo-eye"></svg>
        <div>
          <div class="logo-title">AI SHIELD</div>
          <div class="logo-sub">FORENSIC v1.0</div>
        </div>
      </div>
      <div style="display:flex;align-items:center;gap:6px;margin-top:8px">
        <span class="status-dot"></span>
        <span style="font-size:9px;color:var(--green);font-family:'Orbitron',monospace;letter-spacing:1px">SYSTEM ONLINE</span>
      </div>
    </div>

    <nav>
      <div class="nav-item active" data-page="scanner" onclick="navigate('scanner')">
        <span class="nav-icon">‚¨°</span>SCANNER
      </div>
      <div class="nav-item" data-page="history" onclick="navigate('history')">
        <span class="nav-icon">‚óß</span>HISTORY
      </div>
      <div class="nav-item" data-page="about" onclick="navigate('about')">
        <span class="nav-icon">‚óà</span>ABOUT
      </div>
    </nav>

    <div class="stats-section">
      <div style="font-size:8px;color:var(--dimmer);font-family:'Orbitron',monospace;letter-spacing:2px;margin-bottom:10px">SESSION STATS</div>
      <div class="stat-row">
        <span class="stat-label">TOTAL SCANS</span>
        <span class="stat-val" id="stat-total" style="color:var(--cyan)">0</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">FAKE DETECTED</span>
        <span class="stat-val" id="stat-fake" style="color:var(--red)">0</span>
      </div>
      <div class="stat-row" style="border-bottom:none">
        <span class="stat-label">AUTHENTIC</span>
        <span class="stat-val" id="stat-real" style="color:var(--green)">0</span>
      </div>
    </div>
    <div class="privacy-note">üîí All processing<br>on-device ¬∑ Private</div>
  </aside>

  <!-- MAIN -->
  <main id="main">

    <!-- Top bar -->
    <div id="topbar">
      <div class="topbar-dots">
        <div class="topbar-dot" style="background:var(--red)"></div>
        <div class="topbar-dot" style="background:var(--amber)"></div>
        <div class="topbar-dot" style="background:var(--green)"></div>
      </div>
      <div class="topbar-title" id="topbar-title">‚¨° FORENSIC SCANNER</div>
      <div class="topbar-right">
        <div id="clock"></div>
        <span class="badge" style="color:var(--green);background:rgba(57,255,20,.12);border:1px solid rgba(57,255,20,.3)">ONLINE</span>
      </div>
    </div>

    <!-- Content -->
    <div id="content">

      <!-- SCANNER PAGE -->
      <div id="page-scanner" class="page" style="padding:24px;display:flex;gap:20px;height:100%">
        <!-- Left column -->
        <div style="width:360px;flex-shrink:0;display:flex;flex-direction:column;gap:16px;overflow-y:auto">
          <div>
            <h1 style="font-family:'Orbitron',monospace;font-size:22px;font-weight:900;color:var(--white);letter-spacing:2px;margin-bottom:4px">FORENSIC SCANNER</h1>
            <p style="font-size:12px;color:var(--dim)">Upload any file to detect AI-generated content</p>
          </div>

          <!-- Upload zone -->
          <div class="panel panel-glow-cyan" style="padding:20px">
            <div class="drop-zone" id="drop-zone" onclick="document.getElementById('file-input').click()" ondragover="onDragOver(event)" ondragleave="onDragLeave()" ondrop="onDrop(event)">
              <div id="dz-empty">
                <div style="text-align:center">
                  <div style="font-size:48px;animation:float 3s ease-in-out infinite;margin-bottom:12px">üì°</div>
                  <div style="font-family:'Orbitron',monospace;font-size:13px;color:var(--cyan);letter-spacing:2px;margin-bottom:6px">DROP FILE HERE</div>
                  <div style="font-size:11px;color:var(--dimmer)">or click to browse</div>
                  <div style="font-size:10px;color:var(--dimmest);margin-top:4px">Video ¬∑ Image ¬∑ Audio ¬∑ GIF</div>
                </div>
              </div>
              <div id="dz-selected" style="display:none;width:100%">
                <div id="dz-preview-wrap" style="margin-bottom:12px"></div>
                <div style="display:flex;align-items:center;gap:12px">
                  <div id="dz-type-icon" style="font-size:28px"></div>
                  <div style="flex:1;min-width:0">
                    <div id="dz-filename" style="font-size:13px;color:var(--white);font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap"></div>
                    <div style="display:flex;gap:8px;margin-top:3px;align-items:center">
                      <span id="dz-badge" class="badge"></span>
                      <span id="dz-size" style="font-size:10px;color:var(--dimmer)"></span>
                    </div>
                  </div>
                  <button onclick="clearFile(event)" style="background:none;border:1px solid var(--border);border-radius:8px;padding:5px 8px;color:var(--dim);font-size:11px;cursor:pointer">‚úï</button>
                </div>
              </div>
            </div>
            <input type="file" id="file-input" accept="video/*,image/*,audio/*,.gif" style="display:none" onchange="onFileChange(event)">
            <button class="btn btn-primary full" id="scan-btn" onclick="startScan()" style="margin-top:14px;font-size:12px">‚¨Ü SELECT FILE</button>
          </div>

          <!-- Media type tiles -->
          <div>
            <div class="slabel" style="color:var(--cyan)">DETECTABLE CONTENT</div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
              <div class="panel" style="padding:14px;cursor:pointer" onclick="document.getElementById('file-input').click()">
                <div style="font-size:22px;margin-bottom:8px">üé¨</div>
                <div style="font-family:'Orbitron',monospace;font-size:10px;color:var(--cyan);font-weight:700;margin-bottom:6px;letter-spacing:1px">VIDEO</div>
                <div style="font-size:9px;color:var(--dimmer);line-height:1.7">¬∑ Deepfakes<br>¬∑ Face Swaps<br>¬∑ Lip Sync AI<br>¬∑ Voice Clone</div>
              </div>
              <div class="panel" style="padding:14px;cursor:pointer" onclick="document.getElementById('file-input').click()">
                <div style="font-size:22px;margin-bottom:8px">üñº</div>
                <div style="font-family:'Orbitron',monospace;font-size:10px;color:var(--amber);font-weight:700;margin-bottom:6px;letter-spacing:1px">IMAGE</div>
                <div style="font-size:9px;color:var(--dimmer);line-height:1.7">¬∑ Midjourney<br>¬∑ DALL-E<br>¬∑ Stable Diff.<br>¬∑ Flux</div>
              </div>
              <div class="panel" style="padding:14px;cursor:pointer" onclick="document.getElementById('file-input').click()">
                <div style="font-size:22px;margin-bottom:8px">üéô</div>
                <div style="font-family:'Orbitron',monospace;font-size:10px;color:var(--green);font-weight:700;margin-bottom:6px;letter-spacing:1px">AUDIO</div>
                <div style="font-size:9px;color:var(--dimmer);line-height:1.7">¬∑ ElevenLabs<br>¬∑ VALL-E<br>¬∑ TTS Clones<br>¬∑ Bark AI</div>
              </div>
              <div class="panel" style="padding:14px;cursor:pointer" onclick="document.getElementById('file-input').click()">
                <div style="font-size:22px;margin-bottom:8px">üéû</div>
                <div style="font-family:'Orbitron',monospace;font-size:10px;color:var(--purple);font-weight:700;margin-bottom:6px;letter-spacing:1px">GIF</div>
                <div style="font-size:9px;color:var(--dimmer);line-height:1.7">¬∑ Kling AI<br>¬∑ AI Animation<br>¬∑ Synthetic GIF<br>¬∑ Generated</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right column: hero -->
        <div style="flex:1;display:flex;flex-direction:column;gap:20px;overflow-y:auto">
          <div class="panel" style="padding:40px;text-align:center;background:radial-gradient(ellipse at center,rgba(0,245,255,.06),transparent 70%);min-height:240px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px">
            <div style="position:relative;width:180px;height:180px">
              <div id="hero-orbit1" style="position:absolute;top:2px;left:2px;width:176px;height:176px;border-radius:50%;border:2px solid var(--cyan);opacity:.3;animation:rotCW 10s linear infinite"></div>
              <div id="hero-orbit2" style="position:absolute;top:18px;left:18px;width:144px;height:144px;border-radius:50%;border:1.5px solid var(--green);opacity:.18;animation:rotCCW 14s linear infinite"></div>
              <div id="hero-orbit3" style="position:absolute;top:34px;left:34px;width:112px;height:112px;border-radius:50%;border:1px solid var(--cyan);opacity:.12;animation:rotCW 7s linear infinite"></div>
              <div style="position:absolute;inset:0;border-radius:50%;background:radial-gradient(circle,rgba(0,245,255,.1),transparent 70%);animation:pulse 2s ease-in-out infinite"></div>
              <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)">
                <svg id="hero-eye" width="96" height="96"></svg>
              </div>
            </div>
            <div>
              <h2 style="font-family:'Orbitron',monospace;font-size:26px;font-weight:900;color:var(--cyan);letter-spacing:3px;margin-bottom:8px;animation:glow 3s ease-in-out infinite">DETECT ANY AI CONTENT</h2>
              <p style="font-size:13px;color:var(--dim);max-width:400px;margin:0 auto;line-height:1.7">Advanced forensic analysis using spectral fingerprinting, neural pattern recognition, and metadata archaeology to expose AI-generated media.</p>
            </div>
          </div>

          <!-- Accuracy stats -->
          <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px">
            <div class="panel" style="padding:16px;text-align:center;animation:countUp .6s ease">
              <div style="font-family:'Orbitron',monospace;font-size:20px;font-weight:900;color:var(--cyan);margin-bottom:4px">99.2%</div>
              <div style="font-size:10px;color:var(--dimmer)">Deepfake Accuracy</div>
            </div>
            <div class="panel" style="padding:16px;text-align:center;animation:countUp .6s ease .1s both">
              <div style="font-family:'Orbitron',monospace;font-size:20px;font-weight:900;color:var(--amber);margin-bottom:4px">97.8%</div>
              <div style="font-size:10px;color:var(--dimmer)">AI Image Detection</div>
            </div>
            <div class="panel" style="padding:16px;text-align:center;animation:countUp .6s ease .2s both">
              <div style="font-family:'Orbitron',monospace;font-size:20px;font-weight:900;color:var(--green);margin-bottom:4px">96.4%</div>
              <div style="font-size:10px;color:var(--dimmer)">Voice Clone Det.</div>
            </div>
            <div class="panel" style="padding:16px;text-align:center;animation:countUp .6s ease .3s both">
              <div style="font-family:'Orbitron',monospace;font-size:20px;font-weight:900;color:var(--purple);margin-bottom:4px">&lt;3s</div>
              <div style="font-size:10px;color:var(--dimmer)">Analysis Speed</div>
            </div>
          </div>

          <!-- Pipeline -->
          <div class="panel" style="padding:20px">
            <div class="slabel">ANALYSIS PIPELINE</div>
            <div style="display:flex;align-items:center">
              ${['üìÇ\nLOAD','üéû\nEXTRACT','üëÅ\nDETECT','üß†\nINFER','üéô\nAUDIO','üîç\nMETA','üìã\nREPORT'].map((s,i,a)=>`<div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:6px"><div style="width:36px;height:36px;border-radius:50%;background:rgba(0,245,255,.1);border:1.5px solid rgba(0,245,255,.3);display:flex;align-items:center;justify-content:center;font-size:14px">${s.split('\n')[0]}</div><div style="font-size:7px;color:var(--dimmer);font-family:'Orbitron',monospace;letter-spacing:1px;text-align:center;white-space:pre-line">${s.split('\n')[1]}</div></div>${i<a.length-1?'<div style="width:16px;height:1px;background:linear-gradient(90deg,rgba(0,245,255,.2),rgba(0,245,255,.5),rgba(0,245,255,.2));flex-shrink:0"></div>':''}`).join('')}
            </div>
          </div>
        </div>
      </div>

      <!-- ANALYZING PAGE -->
      <div id="page-analyzing" class="page hidden" style="display:none;padding:24px;gap:20px;height:100%">
        <div style="flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:28px;height:100%">
          <div style="position:relative;width:220px;height:220px">
            <div style="position:absolute;inset:0;border-radius:50%;background:radial-gradient(circle,rgba(0,245,255,.1),transparent 70%);animation:pulse 2s ease-in-out infinite"></div>
            <div style="position:absolute;top:2px;left:2px;width:216px;height:216px;border-radius:50%;border:2px solid var(--cyan);opacity:.35;animation:rotCW 6s linear infinite"></div>
            <div style="position:absolute;top:22px;left:22px;width:176px;height:176px;border-radius:50%;border:1.5px solid var(--green);opacity:.2;animation:rotCCW 9s linear infinite"></div>
            <div style="position:absolute;top:42px;left:42px;width:136px;height:136px;border-radius:50%;border:1px solid var(--cyan);opacity:.15;animation:rotCW 5s linear infinite"></div>
            <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)">
              <svg id="scan-eye" width="110" height="110"></svg>
            </div>
          </div>
          <div style="text-align:center">
            <div style="font-family:'Orbitron',monospace;font-size:30px;font-weight:900;color:var(--cyan);letter-spacing:6px;animation:glow 1.5s ease-in-out infinite">ANALYZING</div>
            <div id="scan-filename" style="font-size:13px;color:var(--dim);margin-top:6px"></div>
          </div>
          <div class="panel" style="padding:24px;width:440px;max-width:90vw">
            <div style="display:flex;justify-content:space-between;margin-bottom:10px">
              <span style="font-size:10px;color:var(--dim);font-family:'Orbitron',monospace;letter-spacing:2px">ANALYSIS PROGRESS</span>
              <span id="prog-pct" style="font-family:'Orbitron',monospace;font-size:16px;font-weight:900;color:var(--cyan)">0%</span>
            </div>
            <div class="progress-bar" style="margin-bottom:14px">
              <div class="progress-fill" id="prog-fill" style="width:0%"></div>
            </div>
            <div id="frame-grid" class="frame-grid" style="margin-bottom:10px"></div>
            <div id="step-label" style="font-family:'Orbitron',monospace;font-size:10px;color:var(--cyan);letter-spacing:1px;text-align:center;animation:blink 1.2s ease-in-out infinite">INITIALIZING...</div>
          </div>
          <div class="panel" style="padding:20px;width:440px;max-width:90vw">
            <div class="slabel">PIPELINE STATUS</div>
            <div id="steps-list"></div>
          </div>
        </div>
      </div>

      <!-- RESULTS PAGE -->
      <div id="page-results" class="page hidden" style="display:none;padding:24px;overflow:auto">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
          <div>
            <div style="font-family:'Orbitron',monospace;font-size:13px;color:var(--cyan);letter-spacing:3px;margin-bottom:4px">FORENSIC ANALYSIS REPORT</div>
            <div id="res-filename" style="font-size:13px;color:var(--dim)"></div>
          </div>
          <div style="display:flex;gap:10px;align-items:center">
            <span class="badge" style="color:var(--green);background:rgba(57,255,20,.12);border:1px solid rgba(57,255,20,.3)">COMPLETE</span>
            <button class="btn btn-outline" onclick="navigate('scanner');clearFile()">‚ü≥ SCAN ANOTHER</button>
          </div>
        </div>
        <!-- Results grid -->
        <div style="display:grid;grid-template-columns:290px 1fr 1fr;gap:16px;margin-bottom:16px">
          <!-- Verdict -->
          <div id="verdict-panel" class="panel" style="padding:28px;text-align:center;display:flex;flex-direction:column;align-items:center;gap:10px;grid-row:span 2">
            <svg id="res-gauge" width="180" height="180"></svg>
            <div id="res-verdict-label" style="font-family:'Orbitron',monospace;font-size:22px;font-weight:900;letter-spacing:3px;animation:glow 2s ease-in-out infinite"></div>
            <div id="res-desc" style="font-size:12px;color:var(--dim);line-height:1.7;margin-top:4px"></div>
            <div id="res-risk" class="badge" style="margin-top:4px"></div>
            <div style="width:100%;margin-top:8px">
              <div style="display:flex;justify-content:space-between;margin-bottom:6px">
                <span style="font-size:9px;color:var(--dim);font-family:'Orbitron',monospace">AI SCORE</span>
                <span id="res-ai-score" style="font-family:'Orbitron',monospace;font-size:13px;font-weight:700"></span>
              </div>
              <div class="progress-bar">
                <div id="res-ai-bar" style="height:100%;border-radius:4px;background:linear-gradient(90deg,var(--green),var(--amber),var(--red));transition:width 1.5s cubic-bezier(.34,1.56,.64,1)"></div>
              </div>
              <div style="display:flex;justify-content:space-between;margin-top:4px">
                <span style="font-size:8px;color:rgba(57,255,20,.5);font-family:'Orbitron',monospace">AUTHENTIC</span>
                <span style="font-size:8px;color:rgba(255,0,85,.5);font-family:'Orbitron',monospace">AI/FAKE</span>
              </div>
            </div>
            <img id="res-preview" style="width:100%;max-height:120px;object-fit:cover;border-radius:10px;margin-top:8px;display:none;opacity:.8" alt="">
          </div>
          <!-- Radar -->
          <div class="panel" style="padding:20px">
            <div class="slabel">FEATURE ANALYSIS</div>
            <div style="display:flex;justify-content:center"><svg id="res-radar" width="220" height="220"></svg></div>
          </div>
          <!-- Issues -->
          <div class="panel" id="issues-panel" style="padding:20px">
            <div id="issues-label" class="slabel"></div>
            <div id="issues-list"></div>
          </div>
          <!-- Frame heatmap -->
          <div class="panel" id="frames-panel" style="padding:20px">
            <div class="slabel">FRAME-BY-FRAME HEATMAP</div>
            <div id="res-frames" class="frame-grid" style="margin-bottom:10px"></div>
            <div style="display:flex;gap:14px;justify-content:center">
              <div style="display:flex;align-items:center;gap:5px"><div style="width:10px;height:10px;border-radius:2px;background:var(--green)"></div><span style="font-size:9px;color:var(--dimmer);font-family:'Orbitron',monospace;letter-spacing:1px">AUTHENTIC</span></div>
              <div style="display:flex;align-items:center;gap:5px"><div style="width:10px;height:10px;border-radius:2px;background:var(--amber)"></div><span style="font-size:9px;color:var(--dimmer);font-family:'Orbitron',monospace;letter-spacing:1px">SUSPICIOUS</span></div>
              <div style="display:flex;align-items:center;gap:5px"><div style="width:10px;height:10px;border-radius:2px;background:var(--red)"></div><span style="font-size:9px;color:var(--dimmer);font-family:'Orbitron',monospace;letter-spacing:1px">MANIPULATED</span></div>
            </div>
          </div>
          <!-- Audio / Spectral -->
          <div class="panel" id="audio-panel" style="padding:20px">
            <div id="audio-label" class="slabel">AUDIO FORENSICS</div>
            <div id="res-waveform" style="margin-bottom:14px"></div>
            <div id="res-audio-segs"></div>
          </div>
        </div>
        <!-- Stats row -->
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px">
          <div class="panel" style="padding:14px;display:flex;align-items:center;gap:12px"><span style="font-size:22px">üéû</span><div><div id="s-frames" style="font-family:'Orbitron',monospace;font-size:18px;font-weight:900;color:var(--white)">‚Äî</div><div style="font-size:10px;color:var(--dimmer)">Frames Analyzed</div></div></div>
          <div class="panel" style="padding:14px;display:flex;align-items:center;gap:12px"><span style="font-size:22px">üë§</span><div><div id="s-faces" style="font-family:'Orbitron',monospace;font-size:18px;font-weight:900;color:var(--white)">‚Äî</div><div style="font-size:10px;color:var(--dimmer)">Faces Detected</div></div></div>
          <div class="panel" style="padding:14px;display:flex;align-items:center;gap:12px"><span style="font-size:22px">‚è±</span><div><div id="s-time" style="font-family:'Orbitron',monospace;font-size:18px;font-weight:900;color:var(--white)">‚Äî</div><div style="font-size:10px;color:var(--dimmer)">Processing Time</div></div></div>
          <div class="panel" style="padding:14px;display:flex;align-items:center;gap:12px"><span style="font-size:22px">üíæ</span><div><div id="s-size" style="font-family:'Orbitron',monospace;font-size:18px;font-weight:900;color:var(--white)">‚Äî</div><div style="font-size:10px;color:var(--dimmer)">File Size</div></div></div>
        </div>
      </div>

      <!-- HISTORY PAGE -->
      <div id="page-history" class="page hidden" style="display:none;padding:24px;display:flex;flex-direction:column;gap:20px;height:100%">
        <div style="display:flex;justify-content:space-between;align-items:center;flex-shrink:0">
          <div>
            <div style="font-family:'Orbitron',monospace;font-size:20px;font-weight:900;color:var(--white);letter-spacing:2px">SCAN HISTORY</div>
            <div id="history-count" style="font-size:12px;color:var(--dim);margin-top:4px">0 analyses recorded</div>
          </div>
          <button class="btn btn-red-outline" onclick="clearHistory()">üóë CLEAR ALL</button>
        </div>
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;flex-shrink:0" id="history-summary"></div>
        <div class="panel" style="flex:1;overflow:hidden;display:flex;flex-direction:column;padding:0">
          <div class="htable-head"><span>FILENAME</span><span>TYPE</span><span>VERDICT</span><span>CONFIDENCE</span><span>DATE</span><span></span></div>
          <div id="history-table" style="flex:1;overflow-y:auto"></div>
        </div>
      </div>

      <!-- ABOUT PAGE -->
      <div id="page-about" class="page hidden" style="display:none;padding:24px;overflow:auto">
        <div style="max-width:960px;margin:0 auto">
          <div style="text-align:center;margin-bottom:40px">
            <svg id="about-eye" width="80" height="80" style="margin:0 auto"></svg>
            <h1 style="font-family:'Orbitron',monospace;font-size:28px;font-weight:900;color:var(--cyan);letter-spacing:4px;margin:20px 0 10px;animation:glow 3s ease-in-out infinite">AI SHIELD</h1>
            <p style="font-size:14px;color:var(--dim);max-width:500px;margin:0 auto;line-height:1.8">Universal AI-generated content detector. Exposes deepfakes, synthetic images, cloned voices, and AI animations using forensic multi-modal analysis.</p>
          </div>
          <div style="margin-bottom:30px">
            <div class="slabel">AI DETECTION MODELS</div>
            <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:14px">
              ${[['EfficientNet-B7','Video Deepfake Detection','96.2%','FaceForensics++','var(--cyan)'],['UniversalFakeDetect','AI Image Detection','94.8%','GenImage','var(--amber)'],['AASIST','Voice Clone Detection','97.1%','ASVspoof 2021','var(--green)'],['XceptionNet','Face Swap Detection','95.9%','Celeb-DF v2','var(--purple)']].map(([n,t,a,d,c])=>`<div class="panel" style="padding:20px;border-color:${c}33"><div style="display:flex;justify-content:space-between;margin-bottom:8px"><div style="font-family:'Orbitron',monospace;font-size:12px;color:${c};font-weight:700">${n}</div><span class="badge" style="color:${c};background:${c}18;border:1px solid ${c}44">${a}</span></div><div style="font-size:12px;color:var(--white);margin-bottom:4px">${t}</div><div style="font-size:10px;color:var(--dimmer)">Dataset: ${d}</div></div>`).join('')}
            </div>
          </div>
          <div class="panel panel-glow-green" style="padding:24px;margin-bottom:20px">
            <div class="slabel" style="color:var(--green)">PRIVACY POLICY</div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
              <div><div style="font-weight:700;color:var(--green);margin-bottom:5px;font-size:13px">Data Collection</div><div style="font-size:12px;color:var(--dim);line-height:1.7">AI Shield does not collect, transmit, or store any of your files. All processing runs entirely in your browser.</div></div>
              <div><div style="font-weight:700;color:var(--green);margin-bottom:5px;font-size:13px">File Access</div><div style="font-size:12px;color:var(--dim);line-height:1.7">Files are loaded into browser memory temporarily for analysis and are never sent to any server.</div></div>
              <div><div style="font-weight:700;color:var(--green);margin-bottom:5px;font-size:13px">No Analytics</div><div style="font-size:12px;color:var(--dim);line-height:1.7">No third-party analytics, advertising SDKs, or crash reporting that sends personal data.</div></div>
              <div><div style="font-weight:700;color:var(--green);margin-bottom:5px;font-size:13px">Transparency</div><div style="font-size:12px;color:var(--dim);line-height:1.7">The detection pipeline is fully transparent. No hidden data collection or server calls of any kind.</div></div>
            </div>
          </div>
          <div class="panel" style="padding:20px">
            <div class="slabel">SUPPORTED FILE FORMATS</div>
            <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px">
              <div style="background:rgba(0,245,255,.06);border-radius:12px;padding:14px;border:1px solid rgba(0,245,255,.18)"><div style="font-size:24px;margin-bottom:6px">üé¨</div><div style="font-family:'Orbitron',monospace;font-size:10px;color:var(--cyan);margin-bottom:8px;font-weight:700">VIDEO</div><div style="font-size:10px;color:var(--dimmer);line-height:1.8">¬∑ MP4<br>¬∑ MOV<br>¬∑ AVI<br>¬∑ MKV<br>¬∑ WEBM<br>¬∑ 3GP</div></div>
              <div style="background:rgba(255,183,0,.06);border-radius:12px;padding:14px;border:1px solid rgba(255,183,0,.18)"><div style="font-size:24px;margin-bottom:6px">üñº</div><div style="font-family:'Orbitron',monospace;font-size:10px;color:var(--amber);margin-bottom:8px;font-weight:700">IMAGE</div><div style="font-size:10px;color:var(--dimmer);line-height:1.8">¬∑ JPG<br>¬∑ PNG<br>¬∑ WEBP<br>¬∑ HEIC<br>¬∑ BMP<br>¬∑ TIFF</div></div>
              <div style="background:rgba(57,255,20,.06);border-radius:12px;padding:14px;border:1px solid rgba(57,255,20,.18)"><div style="font-size:24px;margin-bottom:6px">üéô</div><div style="font-family:'Orbitron',monospace;font-size:10px;color:var(--green);margin-bottom:8px;font-weight:700">AUDIO</div><div style="font-size:10px;color:var(--dimmer);line-height:1.8">¬∑ MP3<br>¬∑ WAV<br>¬∑ AAC<br>¬∑ M4A<br>¬∑ OGG<br>¬∑ FLAC</div></div>
              <div style="background:rgba(191,95,255,.06);border-radius:12px;padding:14px;border:1px solid rgba(191,95,255,.18)"><div style="font-size:24px;margin-bottom:6px">üéû</div><div style="font-family:'Orbitron',monospace;font-size:10px;color:var(--purple);margin-bottom:8px;font-weight:700">GIF</div><div style="font-size:10px;color:var(--dimmer);line-height:1.8">¬∑ GIF<br>¬∑ APNG<br>¬∑ AVIF<br>¬∑ Animated<br>¬∑ Synthetic<br>¬∑ AI-Gen</div></div>
            </div>
          </div>
        </div>
      </div>

    </div><!-- /content -->
  </main>
</div><!-- /app -->

<script>
/* ‚ïê‚ïê‚ïê STATE ‚ïê‚ïê‚ïê */
const state = {
  file: null, mediaType: null, result: null,
  history: [], totalScans: 0, fakeCount: 0,
  scanInterval: null, analysisStartTime: null,
};

/* ‚ïê‚ïê‚ïê MEDIA TYPE ‚ïê‚ïê‚ïê */
function getMediaType(file) {
  const ext = file.name.split('.').pop().toLowerCase();
  const mime = file.type || '';
  if (mime.startsWith('video') || ['mp4','mov','avi','mkv','webm','3gp'].includes(ext)) return 'VIDEO';
  if (ext === 'gif') return 'GIF';
  if (mime.startsWith('audio') || ['mp3','wav','aac','m4a','ogg','flac'].includes(ext)) return 'AUDIO';
  return 'IMAGE';
}
const mtColors = {VIDEO:'var(--cyan)',IMAGE:'var(--amber)',AUDIO:'var(--green)',GIF:'var(--purple)'};
const mtIcons  = {VIDEO:'üé¨',IMAGE:'üñº',AUDIO:'üéô',GIF:'üéû'};

/* ‚ïê‚ïê‚ïê NAVIGATION ‚ïê‚ïê‚ïê */
const pageTitles = {scanner:'‚¨° FORENSIC SCANNER',analyzing:'‚óé ANALYSIS IN PROGRESS',results:'‚óà FORENSIC REPORT',history:'‚óß SCAN HISTORY',about:'‚óà SYSTEM INFO'};
function navigate(page) {
  document.querySelectorAll('.page').forEach(p=>p.classList.add('hidden'));
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  const el = document.getElementById('page-'+page);
  if (el) { el.classList.remove('hidden'); el.style.display = page==='history'?'flex':''; }
  const navEl = document.querySelector(`[data-page="${page==='results'||page==='analyzing'?'scanner':page}"]`);
  if (navEl) navEl.classList.add('active');
  document.getElementById('topbar-title').textContent = pageTitles[page] || '‚¨° FORENSIC SCANNER';
  if (page === 'history') renderHistory();
}

/* ‚ïê‚ïê‚ïê FILE HANDLING ‚ïê‚ïê‚ïê */
function onFileChange(e) { const f = e.target.files[0]; if (f) handleFile(f); }
function onDragOver(e) { e.preventDefault(); document.getElementById('drop-zone').classList.add('drag-over'); }
function onDragLeave() { document.getElementById('drop-zone').classList.remove('drag-over'); }
function onDrop(e) { e.preventDefault(); document.getElementById('drop-zone').classList.remove('drag-over'); const f = e.dataTransfer.files[0]; if (f) handleFile(f); }

function handleFile(file) {
  state.file = file;
  state.mediaType = getMediaType(file);
  const mt = state.mediaType;
  const col = mtColors[mt];

  document.getElementById('dz-empty').style.display = 'none';
  document.getElementById('dz-selected').style.display = 'block';
  document.getElementById('dz-type-icon').textContent = mtIcons[mt];
  document.getElementById('dz-filename').textContent = file.name;
  document.getElementById('dz-size').textContent = (file.size/1024/1024).toFixed(2)+' MB';
  const badge = document.getElementById('dz-badge');
  badge.textContent = mt;
  badge.style.cssText = `color:${col};background:${col}18;border:1px solid ${col}44`;

  // Preview
  const wrap = document.getElementById('dz-preview-wrap');
  wrap.innerHTML = '';
  if (mt === 'IMAGE' || mt === 'GIF') {
    const img = document.createElement('img');
    img.style.cssText = 'width:100%;max-height:160px;object-fit:contain;border-radius:10px';
    const reader = new FileReader();
    reader.onload = e => { img.src = e.target.result; state.previewUrl = e.target.result; };
    reader.readAsDataURL(file);
    wrap.appendChild(img);
  } else if (mt === 'VIDEO') {
    const vid = document.createElement('video');
    vid.style.cssText = 'width:100%;max-height:140px;border-radius:10px;object-fit:cover';
    vid.muted = true; vid.src = URL.createObjectURL(file);
    state.previewUrl = vid.src;
    wrap.appendChild(vid);
  } else {
    wrap.appendChild(buildWaveform('var(--green)', 40, 70));
    state.previewUrl = null;
  }

  // Update scan button
  const btn = document.getElementById('scan-btn');
  btn.textContent = '‚ñ∂ ANALYZE NOW';
  btn.style.background = `linear-gradient(135deg,${col},var(--green))`;
}

function clearFile(e) {
  if (e) e.stopPropagation();
  state.file = null; state.mediaType = null; state.previewUrl = null;
  document.getElementById('dz-empty').style.display = 'flex';
  document.getElementById('dz-selected').style.display = 'none';
  document.getElementById('dz-preview-wrap').innerHTML = '';
  document.getElementById('file-input').value = '';
  const btn = document.getElementById('scan-btn');
  btn.textContent = '‚¨Ü SELECT FILE';
  btn.style.background = 'linear-gradient(135deg,var(--cyan),var(--green))';
}

/* ‚ïê‚ïê‚ïê ANALYSIS ‚ïê‚ïê‚ïê */
const STEPS = [
  {label:'Loading & validating file',icon:'üìÇ'},
  {label:'Extracting media frames',icon:'üéû'},
  {label:'Running face detection',icon:'üëÅ'},
  {label:'Neural model inference',icon:'üß†'},
  {label:'Analyzing audio track',icon:'üéô'},
  {label:'Checking metadata & EXIF',icon:'üîç'},
  {label:'Generating forensic report',icon:'üìã'},
];

function startScan() {
  if (!state.file) { document.getElementById('file-input').click(); return; }
  navigate('analyzing');
  document.getElementById('scan-filename').textContent = state.file.name;

  // Build frame grid
  const fg = document.getElementById('frame-grid');
  fg.innerHTML = '';
  for (let i=0;i<20;i++) {
    const c = document.createElement('div');
    c.className = 'frame-cell';
    c.id = `fc${i}`;
    c.style.cssText = 'background:rgba(255,255,255,.06);border-color:var(--border)';
    c.title = `Frame ${i+1}`;
    fg.appendChild(c);
  }

  // Build steps list
  const sl = document.getElementById('steps-list');
  sl.innerHTML = '';
  STEPS.forEach((s,i) => {
    const row = document.createElement('div');
    row.className = 'step-row'; row.id = `step${i}`;
    row.innerHTML = `<div class="step-dot" id="sdot${i}" style="background:rgba(255,255,255,.05);border:1.5px solid var(--border);color:var(--dimmest);font-size:11px">¬∑</div><div><div id="slabel${i}" style="font-size:11px;color:var(--dimmer)">${s.label}</div><div id="sstatus${i}" style="font-size:9px;color:var(--dimmer);margin-top:2px"></div></div>`;
    sl.appendChild(row);
  });

  let prog = 0, framesDone = 0;
  state.analysisStartTime = Date.now();
  state.scanInterval = setInterval(() => {
    prog = Math.min(prog + 1.05, 100);
    const stepIdx = Math.min(Math.floor(prog/100*STEPS.length), STEPS.length-1);
    const newFrames = Math.floor(prog/5);

    document.getElementById('prog-fill').style.width = prog+'%';
    document.getElementById('prog-pct').textContent = Math.round(prog)+'%';
    document.getElementById('step-label').textContent = STEPS[stepIdx].icon+' '+STEPS[stepIdx].label.toUpperCase();

    // Animate frames
    while (framesDone < newFrames && framesDone < 20) {
      const fc = document.getElementById('fc'+framesDone);
      if (fc) {
        const isFake = Math.random()>.65;
        const col = isFake ? 'var(--amber)' : 'var(--green)';
        fc.style.background = isFake?'rgba(255,183,0,.35)':'rgba(57,255,20,.35)';
        fc.style.borderColor = isFake?'rgba(255,183,0,.6)':'rgba(57,255,20,.6)';
        fc.style.boxShadow = isFake?'0 0 6px rgba(255,183,0,.4)':'0 0 6px rgba(57,255,20,.4)';
      }
      framesDone++;
    }

    // Update steps
    for (let i=0;i<STEPS.length;i++) {
      const dot = document.getElementById('sdot'+i);
      const lbl = document.getElementById('slabel'+i);
      const sts = document.getElementById('sstatus'+i);
      if (i < stepIdx) {
        dot.style.background='rgba(57,255,20,.2)'; dot.style.borderColor='var(--green)';
        dot.style.color='var(--green)'; dot.textContent='‚úì';
        lbl.style.color='var(--white)'; sts.textContent='Complete'; sts.style.color='var(--green)';
      } else if (i === stepIdx) {
        dot.style.background='rgba(0,245,255,.2)'; dot.style.borderColor='var(--cyan)';
        dot.style.color='var(--cyan)'; dot.innerHTML='<span style="animation:blink .8s ease-in-out infinite">‚óè</span>';
        dot.style.boxShadow='0 0 14px rgba(0,245,255,.5)'; dot.style.animation='pulse 1s ease-in-out infinite';
        lbl.style.color='var(--cyan)'; lbl.style.fontWeight='700';
        sts.textContent='RUNNING'; sts.style.color='var(--cyan)'; sts.style.animation='blink 1s ease-in-out infinite';
      }
    }

    if (prog >= 100) {
      clearInterval(state.scanInterval);
      setTimeout(finishAnalysis, 600);
    }
  }, 58);
}

function finishAnalysis() {
  const mt = state.mediaType;
  const aiScore = Math.random();
  const verdict = aiScore < .28 ? 'AUTHENTIC' : aiScore < .56 ? 'SUSPICIOUS' : (mt==='IMAGE'||mt==='GIF') ? 'AI_GENERATED' : 'DEEPFAKE';
  const conf = Math.round(aiScore < .28 ? (1-aiScore)*94 : aiScore>.7 ? aiScore*97 : 52+Math.abs(aiScore-.5)*88);
  const aiPct = Math.round(aiScore*100);
  const frames = Array.from({length:20},()=>Math.random()*(verdict==='AUTHENTIC'?.28:verdict==='SUSPICIOUS'?.6:.95));
  const audioSegs = Array.from({length:8},(_,i)=>({s:i*3,e:(i+1)*3,score:verdict==='AUTHENTIC'?Math.random()*.2:verdict==='SUSPICIOUS'?.3+Math.random()*.4:.65+Math.random()*.3}));
  const radarScores = verdict==='AUTHENTIC'?[.92,.88,.91,.90,.87,.93]:verdict==='SUSPICIOUS'?[.55,.62,.48,.70,.51,.58]:[.88,.82,.91,.75,.85,.78];
  const cats = verdict==='AUTHENTIC'?[]:verdict==='SUSPICIOUS'?['Compression Anomaly','GAN Artifact Trace','Metadata Inconsistency']:(mt==='AUDIO')?['Voice Clone Detected','TTS Vocoder Pattern','Temporal Inconsistency']:(mt==='IMAGE'||mt==='GIF')?['AI-Generated Image','Diffusion Fingerprint','GAN Artifacts','Metadata Absent']:['Deepfake Face Detected','Face Swap Pattern','Voice Clone','Lip-Sync Artifact','GAN Fingerprint'];
  const processingMs = Date.now() - state.analysisStartTime;

  state.result = { file:state.file, mt, verdict, conf, aiPct, frames, audioSegs, radarScores, cats, previewUrl:state.previewUrl, processingMs };

  // Stats
  state.totalScans++;
  if (verdict !== 'AUTHENTIC') state.fakeCount++;
  updateStats();

  // Add to history
  state.history.unshift({ ...state.result, ts: Date.now() });

  renderResults();
  navigate('results');
}

/* ‚ïê‚ïê‚ïê RENDER RESULTS ‚ïê‚ïê‚ïê */
function getVerdictColor(v) { return {AUTHENTIC:'var(--green)',SUSPICIOUS:'var(--amber)',AI_GENERATED:'var(--amber)',DEEPFAKE:'var(--red)'}[v]||'var(--dim)'; }
function getVerdictLabel(v) { return {AUTHENTIC:'‚úì AUTHENTIC',SUSPICIOUS:'‚ö† SUSPICIOUS',AI_GENERATED:'‚úï AI GENERATED',DEEPFAKE:'‚úï DEEPFAKE'}[v]||v; }
function getRiskLabel(v)    { return {AUTHENTIC:'LOW RISK',SUSPICIOUS:'MEDIUM RISK',AI_GENERATED:'HIGH RISK',DEEPFAKE:'VERY HIGH RISK'}[v]||'UNKNOWN'; }
function getVerdictDesc(v,mt){ return {AUTHENTIC:`No AI manipulation detected. This ${(mt||'').toLowerCase()} appears genuine.`,SUSPICIOUS:`Multiple anomalies detected. This content may have been partially AI-altered.`,AI_GENERATED:`This ${(mt||'media').toLowerCase()} was entirely generated by AI.`,DEEPFAKE:'High-confidence deepfake confirmed. Identity manipulation detected across multiple frames.'}[v]||'Analysis complete.'; }

function renderResults() {
  const {file,mt,verdict,conf,aiPct,frames,audioSegs,radarScores,cats,previewUrl,processingMs} = state.result;
  const col = getVerdictColor(verdict);

  document.getElementById('res-filename').textContent = file.name + ' ¬∑ ' + mt;

  // Verdict panel
  const vp = document.getElementById('verdict-panel');
  vp.style.background = `radial-gradient(ellipse at center,${col.replace('var(','')}`.replace(')','').replace('var(','') === col ? `radial-gradient(ellipse at center,${col}18,transparent 70%)` : `radial-gradient(ellipse at center,${col}18,transparent 70%)`;
  vp.style.borderColor = col.replace('var(','').replace(')','') + '44';

  drawGauge(document.getElementById('res-gauge'), conf, col);

  const vl = document.getElementById('res-verdict-label');
  vl.textContent = getVerdictLabel(verdict); vl.style.color = col;

  document.getElementById('res-desc').textContent = getVerdictDesc(verdict, mt);

  const risk = document.getElementById('res-risk');
  risk.textContent = getRiskLabel(verdict); risk.style.cssText = `color:${col};background:${col}18;border:1px solid ${col}44`;

  document.getElementById('res-ai-score').textContent = aiPct+'%';
  document.getElementById('res-ai-score').style.color = col;
  setTimeout(()=>{document.getElementById('res-ai-bar').style.width=aiPct+'%';},100);

  if (previewUrl) {
    const img = document.getElementById('res-preview');
    img.src = previewUrl; img.style.display='block'; img.style.borderColor=col+'44';
    img.onerror=()=>img.style.display='none';
  } else {
    document.getElementById('res-preview').style.display='none';
  }

  // Radar
  drawRadar(document.getElementById('res-radar'), radarScores, col);

  // Issues
  const ip = document.getElementById('issues-panel'); const il = document.getElementById('issues-label'); const ilist = document.getElementById('issues-list');
  il.textContent = cats.length ? 'DETECTED ISSUES' : 'NO ISSUES FOUND';
  il.style.color = cats.length ? col : 'var(--green)';
  if (cats.length === 0) {
    ilist.innerHTML = '<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:160px;gap:10px"><div style="font-size:48px">‚úÖ</div><div style="font-size:13px;color:var(--green);font-weight:700">All checks passed</div><div style="font-size:11px;color:var(--dim)">No manipulation artifacts detected</div></div>';
  } else {
    ilist.innerHTML = cats.map((c,i)=>`<div style="display:flex;gap:10px;padding:10px 0;border-bottom:${i<cats.length-1?'1px solid var(--border)':'none'};animation:fadeUp .4s ease;animation-delay:${i*.1}s;animation-fill-mode:both"><div style="width:6px;height:6px;border-radius:50%;background:${col};margin-top:6px;flex-shrink:0;box-shadow:0 0 6px ${col}"></div><div><div style="font-size:12px;color:var(--white);font-weight:600">${c}</div><div style="font-size:10px;color:var(--dimmer);margin-top:2px">Confidence: ${(75+Math.random()*22).toFixed(1)}%</div></div></div>`).join('');
  }
  if (cats.length) { ip.style.borderColor=col+'33'; ip.style.boxShadow=`0 0 24px ${col}10`; }

  // Frames
  if (mt === 'VIDEO') {
    document.getElementById('frames-panel').style.display='';
    const rf = document.getElementById('res-frames'); rf.innerHTML='';
    frames.forEach((s,i)=>{
      const c=s<.3?'var(--green)':s<.6?'var(--amber)':'var(--red)';
      const alpha = Math.round(30+s*180).toString(16).padStart(2,'0');
      rf.innerHTML+=`<div class="frame-cell" title="Frame ${i+1}: ${Math.round(s*100)}%" style="background:${c===\'var(--green)\'?\'rgba(57,255,20,\':c===\'var(--amber)\'?\'rgba(255,183,0,\':\'rgba(255,0,85,\'}${(0.3+s*.6).toFixed(2)});border-color:${c}22"></div>`;
    });
  } else {
    document.getElementById('frames-panel').style.display='none';
  }

  // Audio
  if (mt === 'AUDIO' || mt === 'VIDEO') {
    document.getElementById('audio-panel').style.display='';
    document.getElementById('audio-label').textContent = mt === 'AUDIO' ? 'AUDIO FORENSICS' : 'AUDIO FORENSICS';
    document.getElementById('res-waveform').innerHTML='';
    document.getElementById('res-waveform').appendChild(buildWaveform(col,40,50));
    const asegs = document.getElementById('res-audio-segs'); asegs.innerHTML='';
    audioSegs.forEach(seg=>{
      const c=seg.score>.5?'var(--red)':'var(--green)';
      asegs.innerHTML+=`<div class="audio-seg"><span style="font-size:10px;color:var(--dimmer);font-family:monospace;width:50px">${seg.s}s‚Äì${seg.e}s</span><div class="audio-bar-bg"><div class="audio-bar-fill" style="width:${seg.score*100}%;background:${c}"></div></div><span class="badge" style="color:${c};background:${c}18;border:1px solid ${c}44;font-size:8px">${seg.score>.5?'AI':'REAL'}</span></div>`;
    });
  } else if (mt === 'IMAGE' || mt === 'GIF') {
    document.getElementById('audio-panel').style.display='';
    document.getElementById('audio-label').textContent='SPECTRAL FINGERPRINT';
    document.getElementById('res-waveform').innerHTML='';
    const asegs=document.getElementById('res-audio-segs'); asegs.innerHTML='';
    [['DCT Anomaly',verdict!=='AUTHENTIC'?60+Math.random()*35:Math.random()*20],['GAN Pattern',verdict!=='AUTHENTIC'?70+Math.random()*28:Math.random()*15],['Diffusion Trace',verdict!=='AUTHENTIC'?55+Math.random()*40:Math.random()*18],['Compression',verdict!=='AUTHENTIC'?50+Math.random()*40:Math.random()*25]].forEach(([label,val])=>{
      asegs.innerHTML+=`<div style="background:rgba(255,255,255,.03);border-radius:10px;padding:12px;margin-bottom:8px"><div style="font-size:9px;color:var(--dimmer);margin-bottom:6px">${label}</div><div style="display:flex;align-items:center;gap:8px"><div style="flex:1;height:4px;background:rgba(255,255,255,.06);border-radius:2px;overflow:hidden"><div style="height:100%;width:${val}%;background:${col};border-radius:2px;transition:width 1s"></div></div><span style="font-size:10px;color:${col};font-family:'Orbitron',monospace;font-weight:700;width:32px;text-align:right">${Math.round(val)}%</span></div></div>`;
    });
  } else {
    document.getElementById('audio-panel').style.display='none';
  }

  // Stats
  document.getElementById('s-frames').textContent = mt==='VIDEO'?'20':mt==='IMAGE'?'1':'N/A';
  document.getElementById('s-faces').textContent = verdict!=='AUTHENTIC'?'2':'2';
  document.getElementById('s-time').textContent = (processingMs/1000).toFixed(1)+'s';
  document.getElementById('s-size').textContent = (file.size/1024/1024).toFixed(2)+' MB';
}

/* ‚ïê‚ïê‚ïê DRAW FUNCTIONS ‚ïê‚ïê‚ïê */
function drawGauge(svg, value, color) {
  const size=180, cx=90, cy=90, r=74;
  const toR=d=>d*Math.PI/180;
  const arc=(a1,a2)=>{
    const x1=cx+r*Math.cos(toR(a1)),y1=cy+r*Math.sin(toR(a1));
    const x2=cx+r*Math.cos(toR(a2)),y2=cy+r*Math.sin(toR(a2));
    return `M ${x1} ${y1} A ${r} ${r} 0 ${a2-a1>180?1:0} 1 ${x2} ${y2}`;
  };
  const colHex = {green:'#39FF14',cyan:'#00F5FF',red:'#FF0055',amber:'#FFB700'}[color.replace('var(--','').replace(')','')]||'#00F5FF';
  svg.innerHTML=`
    <defs><filter id="gf"><feGaussianBlur stdDeviation="3" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs>
    <circle cx="${cx}" cy="${cy}" r="${r+10}" fill="none" stroke="${colHex}" stroke-width=".5" opacity=".07"/>
    <circle cx="${cx}" cy="${cy}" r="${r-10}" fill="none" stroke="${colHex}" stroke-width=".5" opacity=".07"/>
    <path d="${arc(135,405)}" fill="none" stroke="rgba(255,255,255,.06)" stroke-width="12" stroke-linecap="round"/>
    <path d="${arc(135,135+270*value/100)}" fill="none" stroke="${colHex}" stroke-width="12" stroke-linecap="round" filter="url(#gf)" opacity=".95"/>
    <text x="${cx}" y="${cy}" text-anchor="middle" dominant-baseline="middle" fill="${colHex}" font-size="30" font-weight="900" font-family="Orbitron,monospace" filter="url(#gf)">${value}%</text>
    <text x="${cx}" y="${cy+20}" text-anchor="middle" fill="rgba(232,234,246,.5)" font-size="11" font-family="Syne,sans-serif">CONFIDENCE</text>`;
}

function drawRadar(svg, scores, color) {
  const size=220, cx=110, cy=110, r=80;
  const labels=['FACE','MOTION','FREQ','BLINK','TEXTURE','LIGHT'];
  const n=labels.length;
  const toR=d=>d*Math.PI/180;
  const colHex = {green:'#39FF14',cyan:'#00F5FF',red:'#FF0055',amber:'#FFB700'}[color.replace('var(--','').replace(')','')]||'#00F5FF';
  const pts=scores.map((s,i)=>{const a=i/n*Math.PI*2-Math.PI/2;return {x:cx+r*s*Math.cos(a),y:cy+r*s*Math.sin(a)};});
  const poly=pts.map(p=>`${p.x},${p.y}`).join(' ');
  const gridLines=labels.map((_,i)=>{const a=i/n*Math.PI*2-Math.PI/2;return `<line x1="${cx}" y1="${cy}" x2="${cx+r*Math.cos(a)}" y2="${cy+r*Math.sin(a)}" stroke="${colHex}" stroke-width=".5" opacity=".12"/>`}).join('');
  const gridPolys=[.25,.5,.75,1].map(t=>`<polygon points="${labels.map((_,i)=>{const a=i/n*Math.PI*2-Math.PI/2;return `${cx+r*t*Math.cos(a)},${cy+r*t*Math.sin(a)}`;}).join(' ')}" fill="none" stroke="${colHex}" stroke-width=".5" opacity="${t*.18}"/>`).join('');
  const labelEls=labels.map((l,i)=>{const a=i/n*Math.PI*2-Math.PI/2;const lx=cx+(r+22)*Math.cos(a),ly=cy+(r+22)*Math.sin(a);return `<text x="${lx}" y="${ly}" text-anchor="middle" dominant-baseline="middle" fill="rgba(232,234,246,.22)" font-size="8" font-family="Orbitron,monospace" letter-spacing="1">${l}</text>`;}).join('');
  const dots=pts.map(p=>`<circle cx="${p.x}" cy="${p.y}" r="3.5" fill="${colHex}" style="filter:drop-shadow(0 0 4px ${colHex})"/>`).join('');
  svg.innerHTML=`<defs><radialGradient id="rg" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="${colHex}" stop-opacity=".45"/><stop offset="100%" stop-color="${colHex}" stop-opacity=".05"/></radialGradient></defs>${gridPolys}${gridLines}<polygon points="${poly}" fill="url(#rg)" stroke="${colHex}" stroke-width="1.5" style="filter:drop-shadow(0 0 5px ${colHex})"/>${dots}${labelEls}`;
}

function buildWaveform(color, bars=40, height=50) {
  const wrap=document.createElement('div');
  wrap.className='waveform'; wrap.style.height=height+'px';
  for(let i=0;i<bars;i++){
    const b=document.createElement('div');
    b.className='wave-bar';
    const h=15+Math.random()*75;
    b.style.cssText=`flex:1;background:${color};border-radius:2px;opacity:.55;height:${h}%;animation:waveBar ${.4+Math.random()*.7}s ease-in-out infinite alternate;animation-delay:${i*.03}s`;
    wrap.appendChild(b);
  }
  return wrap;
}

/* ‚ïê‚ïê‚ïê HISTORY ‚ïê‚ïê‚ïê */
function renderHistory() {
  const hist = state.history;
  document.getElementById('history-count').textContent = hist.length+' analyses recorded this session';
  const deepfakes=hist.filter(h=>h.verdict==='DEEPFAKE').length;
  const aiGen=hist.filter(h=>h.verdict==='AI_GENERATED'||h.verdict==='SUSPICIOUS').length;
  const authentic=hist.filter(h=>h.verdict==='AUTHENTIC').length;
  document.getElementById('history-summary').innerHTML=`
    <div class="panel" style="padding:16px;text-align:center;border-color:rgba(255,0,85,.22)"><div style="font-family:'Orbitron',monospace;font-size:32px;font-weight:900;color:var(--red);margin-bottom:4px">${deepfakes}</div><div style="font-size:9px;color:var(--red);letter-spacing:2px;font-family:'Orbitron',monospace">DEEPFAKE</div></div>
    <div class="panel" style="padding:16px;text-align:center;border-color:rgba(255,183,0,.22)"><div style="font-family:'Orbitron',monospace;font-size:32px;font-weight:900;color:var(--amber);margin-bottom:4px">${aiGen}</div><div style="font-size:9px;color:var(--amber);letter-spacing:2px;font-family:'Orbitron',monospace">AI / SUSP.</div></div>
    <div class="panel" style="padding:16px;text-align:center;border-color:rgba(57,255,20,.22)"><div style="font-family:'Orbitron',monospace;font-size:32px;font-weight:900;color:var(--green);margin-bottom:4px">${authentic}</div><div style="font-size:9px;color:var(--green);letter-spacing:2px;font-family:'Orbitron',monospace">AUTHENTIC</div></div>
    <div class="panel" style="padding:16px;text-align:center;border-color:rgba(0,245,255,.22)"><div style="font-family:'Orbitron',monospace;font-size:32px;font-weight:900;color:var(--cyan);margin-bottom:4px">${hist.length}</div><div style="font-size:9px;color:var(--cyan);letter-spacing:2px;font-family:'Orbitron',monospace">TOTAL</div></div>`;

  const table=document.getElementById('history-table');
  if(hist.length===0){table.innerHTML='<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;gap:12px"><div style="font-size:64px;opacity:.15">üìã</div><div style="font-size:16px;color:var(--dimmer)">No scans yet</div></div>';return;}
  const fmt=ms=>new Date(ms).toLocaleString('en',{month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'});
  table.innerHTML=hist.map((h,i)=>{
    const col=getVerdictColor(h.verdict);
    const colHex={green:'#39FF14',cyan:'#00F5FF',red:'#FF0055',amber:'#FFB700',purple:'#BF5FFF'}[col.replace('var(--','').replace(')','')]||'#00F5FF';
    return `<div class="htable-row" onclick="viewHistoryItem(${i})" style="animation:fadeUp .4s ease;animation-delay:${i*.05}s;animation-fill-mode:both">
      <div style="display:flex;align-items:center;gap:10px"><span style="font-size:18px">${mtIcons[h.mt]}</span><span style="font-size:12px;color:var(--white);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${h.file?.name||'Unknown'}</span></div>
      <span class="badge" style="color:${col};background:${col}18;border:1px solid ${col}44;font-size:8px">${h.mt}</span>
      <span style="font-family:'Orbitron',monospace;font-size:10px;color:${col};font-weight:700">${h.verdict.replace('_',' ')}</span>
      <div style="display:flex;align-items:center;gap:8px"><div style="flex:1;height:4px;background:rgba(255,255,255,.07);border-radius:2px;overflow:hidden"><div style="height:100%;width:${h.conf}%;background:${col};border-radius:2px"></div></div><span style="font-family:'Orbitron',monospace;font-size:10px;color:${col}">${h.conf}%</span></div>
      <span style="font-size:11px;color:var(--dimmer)">${fmt(h.ts)}</span>
      <span style="font-size:10px;color:var(--cyan);cursor:pointer">VIEW ‚Üí</span>
    </div>`;
  }).join('');
}

function viewHistoryItem(i) { state.result = state.history[i]; renderResults(); navigate('results'); }
function clearHistory() { state.history=[]; renderHistory(); }

/* ‚ïê‚ïê‚ïê STATS ‚ïê‚ïê‚ïê */
function updateStats() {
  document.getElementById('stat-total').textContent=state.totalScans;
  document.getElementById('stat-fake').textContent=state.fakeCount;
  document.getElementById('stat-real').textContent=state.totalScans-state.fakeCount;
}

/* ‚ïê‚ïê‚ïê EYE SVG ‚ïê‚ïê‚ïê */
function buildEye(svgEl, size, color='#00F5FF', scanning=false) {
  const cx=size/2, cy=size/2, ew=size*.43, eh=size*.27;
  const colHex=color;
  svgEl.setAttribute('width',size); svgEl.setAttribute('height',size);
  svgEl.innerHTML=`
    <defs>
      <radialGradient id="iris_${size}" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="#001A22"/><stop offset="60%" stop-color="${colHex}" stop-opacity=".35"/><stop offset="100%" stop-color="${colHex}" stop-opacity=".08"/></radialGradient>
      <clipPath id="ec_${size}"><ellipse cx="${cx}" cy="${cy}" rx="${ew}" ry="${eh}"/></clipPath>
      <filter id="ef_${size}"><feGaussianBlur stdDeviation="2" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
    </defs>
    <ellipse cx="${cx}" cy="${cy}" rx="${ew*1.18}" ry="${eh*1.18}" fill="none" stroke="${colHex}" stroke-width=".8" opacity=".18" style="animation:pulse 2s ease-in-out infinite"/>
    <ellipse cx="${cx}" cy="${cy}" rx="${ew}" ry="${eh}" fill="#010A0F"/>
    <g clip-path="url(#ec_${size})">
      <circle cx="${cx}" cy="${cy}" r="${eh*.9}" fill="url(#iris_${size})"/>
      <circle cx="${cx}" cy="${cy}" r="${eh*.36}" fill="#010810"/>
      <circle cx="${cx}" cy="${cy}" r="${eh*.36}" fill="none" stroke="${colHex}" stroke-width=".9" opacity=".7"/>
      <circle cx="${cx-eh*.1}" cy="${cy-eh*.1}" r="${eh*.07}" fill="white" opacity=".75"/>
    </g>
    <ellipse cx="${cx}" cy="${cy}" rx="${ew}" ry="${eh}" fill="none" stroke="${colHex}" stroke-width="1.4" opacity=".3"/>
    <line x1="${cx-ew+8}" y1="${cy}" x2="${cx+ew-8}" y2="${cy}" stroke="${colHex}" stroke-width=".5" opacity=".2"/>
    ${[[-1,-1],[1,-1],[-1,1],[1,1]].map(([sx,sy])=>{const bx=cx+sx*(ew+8),by=cy+sy*(eh+8),l=8;return `<g stroke="${colHex}" stroke-width="1.8" fill="none" opacity=".55"><line x1="${bx}" y1="${by}" x2="${bx-sx*l}" y2="${by}"/><line x1="${bx}" y1="${by}" x2="${bx}" y2="${by-sy*l}"/></g>`}).join('')}`;

  // Animate iris
  let irisAngle = 0;
  const irisGroup = document.createElementNS('http://www.w3.org/2000/svg','g');
  irisGroup.setAttribute('clip-path',`url(#ec_${size})`);
  const irisLines = Array.from({length:18},(_,i)=>{
    const line=document.createElementNS('http://www.w3.org/2000/svg','line');
    line.setAttribute('stroke',colHex); line.setAttribute('stroke-width','.35'); line.setAttribute('opacity','.2');
    return line;
  });
  irisLines.forEach(l=>irisGroup.appendChild(l));
  svgEl.insertBefore(irisGroup,svgEl.querySelector('circle[fill="#010810"]'));

  let scanPos=.5;
  const scanLine = scanning ? (()=>{ const l=document.createElementNS('http://www.w3.org/2000/svg','line'); l.setAttribute('stroke','#39FF14'); l.setAttribute('stroke-width','1.5'); l.setAttribute('opacity','.9'); l.setAttribute('filter',`url(#ef_${size})`); svgEl.appendChild(l); return l; })() : null;

  function tick(){
    irisAngle+=0.4;
    irisLines.forEach((line,i)=>{
      const a=(i/18)*Math.PI*2+(irisAngle*Math.PI/180);
      const r1=eh*.28,r2=eh*.82;
      line.setAttribute('x1',cx+r1*Math.cos(a)); line.setAttribute('y1',cy+r1*Math.sin(a));
      line.setAttribute('x2',cx+r2*Math.cos(a)); line.setAttribute('y2',cy+r2*Math.sin(a));
    });
    if(scanLine){
      scanPos+=0.007; if(scanPos>1) scanPos=0;
      const sy=cy-eh+scanPos*eh*2;
      scanLine.setAttribute('x1',cx-ew); scanLine.setAttribute('y1',sy);
      scanLine.setAttribute('x2',cx+ew); scanLine.setAttribute('y2',sy);
    }
    requestAnimationFrame(tick);
  }
  tick();
}

/* ‚ïê‚ïê‚ïê PARTICLE BG ‚ïê‚ïê‚ïê */
function initParticles() {
  const c=document.getElementById('bg-canvas'), ctx=c.getContext('2d');
  const resize=()=>{c.width=window.innerWidth;c.height=window.innerHeight;};
  resize(); window.addEventListener('resize',resize);
  const cols=['#00F5FF','#39FF14','#4455FF','#BF5FFF'];
  const pts=Array.from({length:100},()=>({x:Math.random()*c.width,y:Math.random()*c.height,vx:(Math.random()-.5)*.25,vy:(Math.random()-.5)*.25,r:Math.random()*1.2+.2,col:cols[Math.floor(Math.random()*4)]}));
  function tick(){
    ctx.clearRect(0,0,c.width,c.height);
    pts.forEach(p=>{
      p.x+=p.vx; p.y+=p.vy;
      if(p.x<0)p.x=c.width; if(p.x>c.width)p.x=0;
      if(p.y<0)p.y=c.height; if(p.y>c.height)p.y=0;
      ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
      ctx.fillStyle=p.col+'44'; ctx.fill();
    });
    for(let i=0;i<pts.length;i++) for(let j=i+1;j<pts.length;j++){
      const d=Math.hypot(pts[i].x-pts[j].x,pts[i].y-pts[j].y);
      if(d<90){ctx.beginPath();ctx.moveTo(pts[i].x,pts[i].y);ctx.lineTo(pts[j].x,pts[j].y);ctx.strokeStyle='rgba(0,245,255,'+((1-d/90)*.18)+')';ctx.lineWidth=.4;ctx.stroke();}
    }
    requestAnimationFrame(tick);
  }
  tick();
}

/* ‚ïê‚ïê‚ïê HEX GRID ‚ïê‚ïê‚ïê */
function initHexGrid() {
  const svg=document.getElementById('hex-svg'), s=38;
  let html='';
  for(let row=0;row<16;row++) for(let col=0;col<26;col++){
    const cx=col*s*1.5+s, cy=row*s*Math.sqrt(3)+(col%2===1?s*Math.sqrt(3)/2:0);
    const pts=Array.from({length:6},(_,i)=>{const a=Math.PI/180*(60*i-30);return `${cx+s*.9*Math.cos(a)},${cy+s*.9*Math.sin(a)}`;}).join(' ');
    const bright=Math.random()>.88;
    html+=`<polygon points="${pts}" fill="none" stroke="${bright?'#00F5FF':'#1a1a3e'}" stroke-width="${bright?.8:.4}" opacity="${bright?.22:.07}"${bright?` style="animation:pulse ${2+Math.random()*3}s ease-in-out infinite;animation-delay:${Math.random()*3}s"`:''}/>`
  }
  svg.innerHTML=html;
}

/* ‚ïê‚ïê‚ïê CLOCK ‚ïê‚ïê‚ïê */
function updateClock() {
  document.getElementById('clock').textContent=new Date().toLocaleTimeString('en',{hour:'2-digit',minute:'2-digit',second:'2-digit'});
}

/* ‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê */
window.addEventListener('load',()=>{
  initParticles();
  initHexGrid();
  setInterval(updateClock,1000); updateClock();

  // Eyes
  buildEye(document.getElementById('logo-eye'),44,'#00F5FF',false);
  buildEye(document.getElementById('hero-eye'),96,'#00F5FF',false);
  buildEye(document.getElementById('scan-eye'),110,'#00F5FF',true);
  buildEye(document.getElementById('about-eye'),80,'#00F5FF',false);

  navigate('scanner');
});
</script>
</body>
</html>
